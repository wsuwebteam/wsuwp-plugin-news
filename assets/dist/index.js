(()=>{"use strict";var e,t={420:(e,t,a)=>{var r={};a.r(r),a.d(r,{author:()=>_,media_contact:()=>g});const i=window.wp.element,s=window.lodash,o=window.wp.i18n,n=window.wp.components,l=window.wp.data,m=window.wp.compose,c=window.wp.apiFetch;var h=a.n(c);const d=window.wp.url;function p(e){const t=e.map((e=>({children:[],parent:null,...e}))),a=(0,s.groupBy)(t,"parent");if(a.null&&a.null.length)return t;const r=e=>e.map((e=>{const t=a[e.id];return{...e,children:t&&t.length?r(t):[]}}));return r(a[0]||[])}const u=window.React,g=(0,u.forwardRef)((function(e,t){const[a,r]=(0,i.useState)(e.defaultValue),o=e=>{const t=e.target.name,a=e.target.value;r(""===a?e=>(0,s.omit)(e,t):e=>({...e,[t]:a}))};return(0,i.useEffect)((()=>{(0,s.isEmpty)(a)||e.onChange(a)}),[a]),(0,u.useImperativeHandle)(t,(()=>({clearMetaData(){r({})}}))),(0,i.createElement)(i.Fragment,null,(0,i.createElement)("label",{htmlFor:"editor-post-taxonomies__hierarchical-terms-organization-"+e.instanceId,className:"editor-post-taxonomies__hierarchical-terms-label"},"Organization/Affiliation"),(0,i.createElement)("input",{name:"organization",type:"text",id:"editor-post-taxonomies__hierarchical-terms-organization-"+e.instanceId,className:"editor-post-taxonomies__hierarchical-terms-input",value:a.organization||"",onChange:o}),(0,i.createElement)("label",{htmlFor:"editor-post-taxonomies__hierarchical-terms-email-"+e.instanceId,className:"editor-post-taxonomies__hierarchical-terms-label"},"Email"),(0,i.createElement)("input",{name:"email",type:"text",id:"editor-post-taxonomies__hierarchical-terms-email-"+e.instanceId,className:"editor-post-taxonomies__hierarchical-terms-input",value:a.email||"",onChange:o}),(0,i.createElement)("label",{htmlFor:"editor-post-taxonomies__hierarchical-terms-phone-"+e.instanceId,className:"editor-post-taxonomies__hierarchical-terms-label"},"Phone Number"),(0,i.createElement)("input",{name:"phone_number",type:"text",id:"editor-post-taxonomies__hierarchical-terms-phone-"+e.instanceId,className:"editor-post-taxonomies__hierarchical-terms-input",value:a.phone_number||"",onChange:o}))})),_=(0,u.forwardRef)((function(e,t){const[a,r]=(0,i.useState)(e.defaultValue),o=e=>{const t=e.target.name,a=e.target.value;r(""===a?e=>(0,s.omit)(e,t):e=>({...e,[t]:a}))};return(0,i.useEffect)((()=>{(0,s.isEmpty)(a)||e.onChange(a)}),[a]),(0,u.useImperativeHandle)(t,(()=>({clearMetaData(){r({})}}))),(0,i.createElement)(i.Fragment,null,(0,i.createElement)("label",{htmlFor:"editor-post-taxonomies__hierarchical-terms-organization-"+e.instanceId,className:"editor-post-taxonomies__hierarchical-terms-label"},"Organization/Affiliation"),(0,i.createElement)("input",{name:"organization",type:"text",id:"editor-post-taxonomies__hierarchical-terms-organization-"+e.instanceId,className:"editor-post-taxonomies__hierarchical-terms-input",value:a.organization||"",onChange:o}),(0,i.createElement)("label",{htmlFor:"editor-post-taxonomies__hierarchical-terms-email-"+e.instanceId,className:"editor-post-taxonomies__hierarchical-terms-label"},"Email"),(0,i.createElement)("input",{name:"email",type:"text",id:"editor-post-taxonomies__hierarchical-terms-email-"+e.instanceId,className:"editor-post-taxonomies__hierarchical-terms-input",value:a.email||"",onChange:o}))})),f={per_page:200,orderby:"name",order:"asc",_fields:"id,name,parent"};class b extends i.Component{constructor(){super(...arguments),this.findTerm=this.findTerm.bind(this),this.onChange=this.onChange.bind(this),this.onChangeFormName=this.onChangeFormName.bind(this),this.onChangeFormDescription=this.onChangeFormDescription.bind(this),this.onChangeFormMeta=this.onChangeFormMeta.bind(this),this.onChangeFormParent=this.onChangeFormParent.bind(this),this.onAddTerm=this.onAddTerm.bind(this),this.onToggleForm=this.onToggleForm.bind(this),this.setFilterValue=this.setFilterValue.bind(this),this.sortBySelected=this.sortBySelected.bind(this),this.state={loading:!0,availableTermsTree:[],availableTerms:[],adding:!1,formName:"",formDescription:"",formMeta:{},formParent:"",showForm:!1,filterValue:"",filteredTermsTree:[]},this.metaFields=React.createRef()}onChange(e){const{onUpdateTerms:t,terms:a=[],taxonomy:r}=this.props;t(-1!==a.indexOf(e)?(0,s.without)(a,e):[...a,e],r.rest_base)}onChangeFormName(e){const t=""===e.target.value.trim()?"":e.target.value;this.setState({formName:t})}onChangeFormDescription(e){const t=""===e.target.value.trim()?"":e.target.value;this.setState({formDescription:t})}onChangeFormMeta(e){this.setState({formMeta:e})}onChangeFormParent(e){this.setState({formParent:e})}onToggleForm(){this.setState((e=>({showForm:!e.showForm})))}findTerm(e,t,a){return(0,s.find)(e,(e=>(!e.parent&&!t||parseInt(e.parent)===parseInt(t))&&e.name.toLowerCase()===a.toLowerCase()))}onAddTerm(e){e.preventDefault();const{onUpdateTerms:t,taxonomy:a,terms:r,slug:i}=this.props,{formName:n,formDescription:l,formMeta:m,formParent:c,adding:u,availableTerms:g}=this.state;if(""===n||u)return;const _=this.findTerm(g,c,n);if(_)return(0,s.some)(r,(e=>e===_.id))||t([...r,_.id],a.rest_base),this.setState({formName:"",formParent:"",formDescription:"",formMeta:{}}),this.metaFields.current.clearMetaData(),void this.onToggleForm();this.setState({adding:!0}),this.addRequest=h()({path:`/wp/v2/${a.rest_base}`,method:"POST",data:{name:n,parent:c||void 0,description:l||void 0,meta:m||void 0}}),this.addRequest.catch((e=>"term_exists"===e.code?(this.addRequest=h()({path:(0,d.addQueryArgs)(`/wp/v2/${a.rest_base}`,{...f,parent:c||0,search:n})}),this.addRequest.then((e=>this.findTerm(e,c,n)))):Promise.reject(e))).then((e=>{const n=(0,s.find)(this.state.availableTerms,(t=>t.id===e.id))?this.state.availableTerms:[e,...this.state.availableTerms],l=(0,o.sprintf)(
/* translators: %s: taxonomy name */
(0,o._x)("%s added","term"),(0,s.get)(this.props.taxonomy,["labels","singular_name"],"category"===i?(0,o.__)("Category"):(0,o.__)("Term")));this.props.speak(l,"assertive"),this.addRequest=null,this.setState({adding:!1,formName:"",formParent:"",formDescription:"",formMeta:{},availableTerms:n,availableTermsTree:this.sortBySelected(p(n))}),this.metaFields.current.clearMetaData(),this.onToggleForm(),t([...r,e.id],a.rest_base)}),(e=>{"abort"!==e.statusText&&(this.addRequest=null,this.setState({adding:!1}))}))}componentDidMount(){this.fetchTerms()}componentWillUnmount(){(0,s.invoke)(this.fetchRequest,["abort"]),(0,s.invoke)(this.addRequest,["abort"])}componentDidUpdate(e){this.props.taxonomy!==e.taxonomy&&this.fetchTerms()}fetchTerms(){const{taxonomy:e}=this.props;e&&(this.fetchRequest=h()({path:(0,d.addQueryArgs)(`/wp/v2/${e.rest_base}`,f)}),this.fetchRequest.then((e=>{const t=this.sortBySelected(p(e));this.fetchRequest=null,this.setState({loading:!1,availableTermsTree:t,availableTerms:e})}),(e=>{"abort"!==e.statusText&&(this.fetchRequest=null,this.setState({loading:!1}))})))}sortBySelected(e){const{terms:t}=this.props,a=e=>-1!==t.indexOf(e.id)||void 0!==e.children&&!!(e.children.map(a).filter((e=>e)).length>0);return e.sort(((e,t)=>{const r=a(e),i=a(t);return r===i?0:r&&!i?-1:!r&&i?1:0})),e}setFilterValue(e){const{availableTermsTree:t}=this.state,a=e.target.value,r=t.map(this.getFilterMatcher(a)).filter((e=>e)),i=e=>{let t=0;for(let a=0;a<e.length;a++)t++,void 0!==e[a].children&&(t+=i(e[a].children));return t};this.setState({filterValue:a,filteredTermsTree:r});const s=i(r),n=(0,o.sprintf)(
/* translators: %d: number of results */
(0,o._n)("%d result found.","%d results found.",s),s);this.props.debouncedSpeak(n,"assertive")}getFilterMatcher(e){const t=a=>{if(""===e)return a;const r={...a};return r.children.length>0&&(r.children=r.children.map(t).filter((e=>e))),(-1!==r.name.toLowerCase().indexOf(e.toLowerCase())||r.children.length>0)&&r};return t}renderTerms(e){const{terms:t=[]}=this.props;return e.map((e=>(0,i.createElement)("div",{key:e.id,className:"editor-post-taxonomies__hierarchical-terms-choice"},(0,i.createElement)(n.CheckboxControl,{checked:-1!==t.indexOf(e.id),onChange:()=>{const t=parseInt(e.id,10);this.onChange(t)},label:(0,s.unescape)(e.name)}),!!e.children.length&&(0,i.createElement)("div",{className:"editor-post-taxonomies__hierarchical-terms-subchoices"},this.renderTerms(e.children)))))}render(){const{slug:e,taxonomy:t,instanceId:a,hasCreateAction:l,hasAssignAction:m}=this.props;if(!m)return null;const{availableTermsTree:c,availableTerms:h,filteredTermsTree:d,formName:p,formDescription:u,formParent:g,loading:_,showForm:f,filterValue:b}=this.state,v=(a,r,i)=>(0,s.get)(t,["labels",a],"category"===e?r:i),x=v("add_new_item",(0,o.__)("Add new category"),(0,o.__)("Add new term")),w=v("new_item_name",(0,o.__)("Add new category"),(0,o.__)("Add new term")),T=v("parent_item",(0,o.__)("Parent Category"),(0,o.__)("Parent Term")),y=`— ${T} —`,C=x,F=`editor-post-taxonomies__hierarchical-terms-input-${a}`,E=`editor-post-taxonomies__hierarchical-terms-filter-${a}`,N=(0,s.get)(this.props.taxonomy,["labels","search_items"],(0,o.__)("Search Terms")),S=(0,s.get)(this.props.taxonomy,["name"],(0,o.__)("Terms")),k=h.length>=8,P=r[t.slug];return[k&&(0,i.createElement)("label",{key:"filter-label",htmlFor:E},N),k&&(0,i.createElement)("input",{type:"search",id:E,value:b,onChange:this.setFilterValue,className:"editor-post-taxonomies__hierarchical-terms-filter",key:"term-filter-input"}),(0,i.createElement)("div",{className:"editor-post-taxonomies__hierarchical-terms-list",key:"term-list",tabIndex:"0",role:"group","aria-label":S},this.renderTerms(""!==b?d:c)),!_&&l&&(0,i.createElement)(n.Button,{key:"term-add-button",onClick:this.onToggleForm,className:"editor-post-taxonomies__hierarchical-terms-add","aria-expanded":f,isLink:!0},x),f&&(0,i.createElement)(n.Modal,{key:"hierarchical-terms-form-modal",title:"Add New "+t.labels.singular_name,onRequestClose:this.onToggleForm},(0,i.createElement)("form",{onSubmit:this.onAddTerm,className:"hierarchical-terms-form"},(0,i.createElement)("label",{htmlFor:F,className:"editor-post-taxonomies__hierarchical-terms-label"},w),(0,i.createElement)("input",{type:"text",id:F,className:"editor-post-taxonomies__hierarchical-terms-input",value:p,onChange:this.onChangeFormName,required:!0}),(0,i.createElement)("label",{htmlFor:"editor-post-taxonomies__hierarchical-terms-description-"+a,className:"editor-post-taxonomies__hierarchical-terms-label"},"Description"),(0,i.createElement)("textarea",{id:"editor-post-taxonomies__hierarchical-terms-description-"+a,className:"editor-post-taxonomies__hierarchical-terms-input",value:u,onChange:this.onChangeFormDescription}),(0,i.createElement)(P,{ref:this.metaFields,onChange:this.onChangeFormMeta,instanceId:a,defaultValue:this.state.formMeta}),!!h.length&&t.hierarchical&&(0,i.createElement)(n.TreeSelect,{className:"wsu-custom-term-selector__tree-select",label:T,noOptionLabel:y,onChange:this.onChangeFormParent,selectedId:g,tree:c}),(0,i.createElement)(n.Button,{isSecondary:!0,type:"submit",className:"editor-post-taxonomies__hierarchical-terms-submit wsu-custom-term-selector__hierarchical-terms-submit"},C)))]}}const v=(0,m.compose)([(0,l.withSelect)(((e,t)=>{let{slug:a}=t;const{getCurrentPost:r}=e("core/editor"),{getTaxonomy:i}=e("core"),o=i(a);return{hasCreateAction:!!o&&(0,s.get)(r(),["_links","wp:action-create-"+o.rest_base],!1),hasAssignAction:!!o&&(0,s.get)(r(),["_links","wp:action-assign-"+o.rest_base],!1),terms:o?e("core/editor").getEditedPostAttribute(o.rest_base):[],taxonomy:o}})),(0,l.withDispatch)((e=>({onUpdateTerms(t,a){e("core/editor").editPost({[a]:t})}}))),n.withSpokenMessages,m.withInstanceId])(b);wp.hooks.addFilter("editor.PostTaxonomyType","wsuwp-plugin-news",(function(e){const t=["media_contact","author"];return function(a){return t.includes(a.slug)?(0,i.createElement)(v,a):(0,i.createElement)(e,a)}}))}},a={};function r(e){var i=a[e];if(void 0!==i)return i.exports;var s=a[e]={exports:{}};return t[e](s,s.exports,r),s.exports}r.m=t,e=[],r.O=(t,a,i,s)=>{if(!a){var o=1/0;for(c=0;c<e.length;c++){for(var[a,i,s]=e[c],n=!0,l=0;l<a.length;l++)(!1&s||o>=s)&&Object.keys(r.O).every((e=>r.O[e](a[l])))?a.splice(l--,1):(n=!1,s<o&&(o=s));if(n){e.splice(c--,1);var m=i();void 0!==m&&(t=m)}}return t}s=s||0;for(var c=e.length;c>0&&e[c-1][2]>s;c--)e[c]=e[c-1];e[c]=[a,i,s]},r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},r.d=(e,t)=>{for(var a in t)r.o(t,a)&&!r.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e={826:0,431:0};r.O.j=t=>0===e[t];var t=(t,a)=>{var i,s,[o,n,l]=a,m=0;if(o.some((t=>0!==e[t]))){for(i in n)r.o(n,i)&&(r.m[i]=n[i]);if(l)var c=l(r)}for(t&&t(a);m<o.length;m++)s=o[m],r.o(e,s)&&e[s]&&e[s][0](),e[s]=0;return r.O(c)},a=globalThis.webpackChunkwsuwp_plugin_news=globalThis.webpackChunkwsuwp_plugin_news||[];a.forEach(t.bind(null,0)),a.push=t.bind(null,a.push.bind(a))})();var i=r.O(void 0,[431],(()=>r(420)));i=r.O(i)})();